# せどりツールDIY部オフ会企画

## 要件

```
■要件
①スプシ+GAS、またはpython+エクセルのツールであること
②keepa APIを利用すること
③「リサーチ」シートのA列に列挙されているASINについて情報を取得してB列以降に表示すること
表示する情報は下記とする
  B列: 商品名
  C列: カート価格
  D列: Amazonの商品ページへのリンク
④その他、ツールに必要な情報などはE列以降に自由に表示してよい
⑤A列のASINの数は、一回にkeepaで取得できる量よりも多いことを想定して、実行のたびに一番情報が古いデータを更新すること
⑥keepaのAPIキーと、⑤の一回の更新数はコードに埋め込まず、「設定」シートのセルに入力されたものを使用する
⑦ASINは全て正しいことを前提として、実在しない場合の処理は不要とする
⑧オフ会での共有のしやすさを優先し、コードはファイル分割せず1ファイルとする
・スプシ+GASで1ファイルとし、GASの.gsも一つのみ
・エクセル1ファイルとpyファイル1つ
⑨グーグルドライブ内のスプシとエクセルのサンプルを流用して作成し、スプシ、エクセルで変更したセルは薄い青色ハイライトにすること
⑩ツールはオフ会の前日までに、ファイル名を「連番_名前」にして指定されたグーグルドライブに格納すること
(連番は、ファイルを格納した方から、1を使ってください。ファイル格納後も内容修正いただいて構いません)

■格納フォルダ、サンプルファイル
https://drive.google.com/drive/folders/1N_5nJow61ZWqhsQHuB6cwpgjLxQOVYSb

・格納する際のgoogleアカウントについて、本名が見えてしまわないよう、アカウント、またはアカウントの名前に気をつけて下さい。
・設定シートのkeepa APIキーは必ず削除した上でアップしてください


■オフ会後について
オフ会後も、格納いただいたツールは概要欄からアクセスできるようにする予定です。
本チャット参加者の不特定多数に公開されても構わない範囲内で作成ください。
オフ会当日に参加できなかった方が、なぜこういう処理にしているのか理解できるよう、ソース内のコメント多めだと嬉しいです。


■その他
・ツール要件について、足したほうがいいもの、変更したほうがいいものあれば、この投稿への返信でご連絡ください！
・リサーチツールとして考えると今回表示するデータは物足りないですが、データのリッチさは今回の目的ではないので、最低限のものにしています。
・他の方がコードを変更しなくても簡単に動作確認ができるようにするため、キーなどの設定項目はスプシ、エクセルに書くようにしています。その他にも同様に設定すべき値があれば、設定シートにセルを作って読み込む仕様としてください。
```

## メニュー

`シート更新`
- クリックで、前回終了時点のASINの次のデータから更新
- 現在の実行状態をtoast表示
    - Keepa情報取得...(N行目)
    - Keepa情報取得完了(N行目)
- エラー等で中断した場合、その時点での更新位置を保持
    - Error内容をtoast表示

## プロパティ

|名前           |型                     |内容                        |初期値|
|---------------|-----------------------|----------------------------|------|
|last_update_row|{[asin:string]: number}|前回の更新ASINと行番号      |{}    |
|keepa_api_key  |string                 |KeepaAPIキー                |-     |
|update_asin_len|number                 |更新処理で処理する最大ASIN数|-     |

- `keepa_api_key`は設定シートから取得
    - スクリプトからは名前付き範囲`keepa_key`で参照する
- `update_asin_len`は設定シートから取得
    - スクリプトからは名前付き範囲`update_asi_len`で参照する

